(function(t){function e(e){for(var s,o,n=e[0],l=e[1],c=e[2],u=0,p=[];u<n.length;u++)o=n[u],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);d&&d(e);while(p.length)p.shift()();return r.push.apply(r,c||[]),a()}function a(){for(var t,e=0;e<r.length;e++){for(var a=r[e],s=!0,n=1;n<a.length;n++){var l=a[n];0!==i[l]&&(s=!1)}s&&(r.splice(e--,1),t=o(o.s=a[0]))}return t}var s={},i={app:0},r=[];function o(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=t,o.c=s,o.d=function(t,e,a){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)o.d(a,s,function(e){return t[e]}.bind(null,s));return a},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="";var n=window["webpackJsonp"]=window["webpackJsonp"]||[],l=n.push.bind(n);n.push=e,n=n.slice();for(var c=0;c<n.length;c++)e(n[c]);var d=l;r.push([1,"chunk-vendors"]),a()})({0:function(t,e){},"034f":function(t,e,a){"use strict";var s=a("64a9"),i=a.n(s);i.a},"0c36":function(t,e,a){},"0d64":function(t,e,a){t.exports=a.p+"img/banner2.d88801d1.jpg"},1:function(t,e,a){t.exports=a("56d7")},2:function(t,e){},3:function(t,e){},"302c":function(t,e,a){t.exports=a.p+"img/riscocaixa.5777b301.png"},"38b6":function(t,e,a){},4212:function(t,e,a){},"438d":function(t,e,a){t.exports=a.p+"img/logo-pdo-azul.f06e9a4a.png"},"56d7":function(t,e,a){"use strict";a.r(e);a("cadf"),a("551c"),a("f751"),a("097d");var s=a("2b0e"),i=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{attrs:{id:"app"}},[s("div",{staticClass:"cabecalho"},[s("img",{attrs:{alt:"PDO logo",src:a("438d")}}),s("div",{staticClass:"canto"},[-1==t.local.indexOf("www.gigovvt")&&-1==t.local.indexOf("localhost:8082")?s("div",{staticClass:"botaodoacao",attrs:{"bg-variant":"warning"}},[s("span",[t._v("\n        Ajude a manter o site atualizado e funcionando doando um valor clicando no botão.\n        ")]),s("b-button",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-multi-1",modifiers:{"modal-multi-1":!0}}],staticClass:"mt-3",attrs:{"text-danger":"",size:"sm",pill:"",variant:"warning"}},[t._v("Doar")])],1):t._e(),s("img",{attrs:{alt:"PDO logo",src:a("bc5c")}})])]),s("b-modal",{attrs:{id:"modal-multi-1",size:"lg","body-bg-variant":"info","footer-bg-variant":"info","header-bg-variant":"info",title:"Escolha uma das opções de doação abaixo","body-text-variant":"light","header-text-variant":"light",centered:"","modal-ok":""}},[s("div",{staticClass:"doacao"},[s("div",{staticClass:"paypal"},[s("h3",[t._v("Paypal")]),s("form",{attrs:{action:"https://www.paypal.com/cgi-bin/webscr",method:"post",target:"_top"}},[s("input",{attrs:{type:"hidden",name:"cmd",value:"_s-xclick"}}),s("input",{attrs:{type:"hidden",name:"hosted_button_id",value:"R2WRWGCUQNSBL"}}),s("input",{attrs:{type:"image",src:"https://www.paypalobjects.com/pt_BR/BR/i/btn/btn_donateCC_LG.gif",border:"0",name:"submit",title:"PayPal - The safer, easier way to pay online!",alt:"Faça doações com o botão do PayPal"}}),s("img",{attrs:{alt:"",border:"0",src:"https://www.paypal.com/pt_BR/i/scr/pixel.gif",width:"1",height:"1"}})])]),s("div",{staticClass:"pagseguro"},[s("h3",[t._v("PagSeguro")]),s("form",{attrs:{action:"https://pagseguro.uol.com.br/checkout/v2/donation.html",method:"post"}},[s("input",{attrs:{type:"hidden",name:"currency",value:"BRL"}}),s("input",{attrs:{type:"hidden",name:"receiverEmail",value:"carlosfredericodemborges@gmail.com"}}),s("input",{attrs:{type:"hidden",name:"iot",value:"button"}}),s("input",{attrs:{type:"image",src:"https://stc.pagseguro.uol.com.br/public/img/botoes/doacoes/120x53-doar-azul.gif",name:"submit",alt:"Pague com PagSeguro - é rápido, grátis e seguro!"}})])]),s("div",{staticClass:"picpay"},[s("h3",[t._v("PicPay")]),s("img",{directives:[{name:"b-modal",rawName:"v-b-modal.modal-multi-2",modifiers:{"modal-multi-2":!0}}],attrs:{src:a("a6f6"),alt:""}})])])]),s("b-modal",{attrs:{id:"modal-multi-2",title:"Doar com PicPay","ok-only":"",centered:""}},[s("div",{staticClass:"qr-picpay"},[s("img",{attrs:{src:a("626a5"),alt:""}})])]),s("div",{staticClass:"conteudo"},[s("div",{staticClass:"params"},[s("keep-alive",[s("Params")],1)],1),s("div",{ref:"grid",staticClass:"grid"},[s("keep-alive",[s("Grid")],1)],1)]),s("div",{staticClass:"rodape"},[s("keep-alive",[s("Rodape")],1)],1),s("div",{staticClass:"banner"},[t.local.indexOf("www.gigovvt")>-1||t.local.indexOf("localhost:8082")>-1?s("div",[s("img",{attrs:{src:a("62f2"),alt:""}}),s("img",{attrs:{src:a("6ff5"),alt:""}}),s("img",{attrs:{src:a("302c"),alt:""}})]):s("div",[s("img",{attrs:{src:a("ba57"),alt:""}}),s("img",{attrs:{src:a("0d64"),alt:""}}),s("img",{attrs:{src:a("8c21"),alt:""}})])])],1)},r=[],o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"conteudoParams"},[a("div",{staticClass:"campos"},[a("div",{staticClass:"field",attrs:{title:"Seleciona UF"}},[t._v("\n          UF: \n          "),a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.params.UF,expression:"params.UF",modifiers:{lazy:!0}}],attrs:{type:"text"},domProps:{value:t.params.UF},on:{change:[function(e){return t.$set(t.params,"UF",e.target.value)},function(e){return t.saveParams()}]}})]),a("div",{staticClass:"field",attrs:{title:"Define BDI"}},[t._v("\n          BDI: \n          "),a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.params.BDI,expression:"params.BDI",modifiers:{lazy:!0}}],attrs:{type:"number",step:"0.01",min:"0",max:"80"},domProps:{value:t.params.BDI},on:{change:[function(e){return t.$set(t.params,"BDI",e.target.value)},function(e){return t.saveParams()}]}})]),a("div",{staticClass:"field",staticStyle:{position:"relative"},attrs:{title:"Seleciona Data Base Disponível"}},[t._v("\n          Data Base:\n          "),a("b-form-select",{attrs:{options:t.registros},on:{change:function(e){return t.saveParams()}},model:{value:t.params.base,callback:function(e){t.$set(t.params,"base",e)},expression:"params.base"}})],1),a("div",{staticClass:"field"},[a("b-form-checkbox",{attrs:{size:"lg",switch:"",variant:"danger",value:"1","unchecked-value":"0"},nativeOn:{change:function(e){return t.saveParams()}},model:{value:t.params.desonerado,callback:function(e){t.$set(t.params,"desonerado",e)},expression:"params.desonerado"}},[t._v("Desonerado\n        ")])],1),a("div",{attrs:{title:"Totaliza Planilha"}},[a("i",{staticClass:"fa fa-calculator fa-2x",on:{click:function(e){return t.totalizaItens()}}})])]),a("div",{staticClass:"acoesParams"},[a("div",{attrs:{title:"Importa Planilha .xlsx"},on:{click:function(e){return t.escolheArquivo()}}},[a("i",{staticClass:"fa fa-long-arrow-up text-success fa-2x"}),a("i",{staticClass:"fa fa-file-excel-o text-success fa-2x"})]),a("div",{attrs:{title:"Exporta em formato .xlsx"},on:{click:function(e){return t.onexport()}}},[a("i",{staticClass:"fa fa-file-excel-o fa-2x text-success"}),a("i",{staticClass:"fa fa-long-arrow-down text-success fa-2x"})]),a("div",{attrs:{title:"Limpa Planilha"},on:{click:function(e){return t.limpaPlanilha()}}},[a("i",{staticClass:"fa fa fa-trash fa-2x text-danger",attrs:{"aria-hidden":"true"}})])]),a("b-modal",{attrs:{id:"modal-2",size:"xl","hide-footer":"",centered:"",title:"Carrega Planilha .xlsx"}},[a("div",{staticClass:"d-block",staticStyle:{"text-align":"center !important"}},[a("span",{staticClass:"titulo"},[t._v("\n        Informe os parâmetros do projeto\n      ")]),a("div",{staticClass:"campos"},[a("div",{staticClass:"field",attrs:{title:"Define BDI"}},[t._v("\n              BDI: \n              "),a("input",{directives:[{name:"model",rawName:"v-model.lazy",value:t.newparams.BDI,expression:"newparams.BDI",modifiers:{lazy:!0}}],staticStyle:{width:"70px"},attrs:{type:"number",step:"0.01",min:"0",max:"80"},domProps:{value:t.newparams.BDI},on:{change:function(e){return t.$set(t.newparams,"BDI",e.target.value)}}})]),a("div",{staticClass:"field",staticStyle:{position:"relative"},attrs:{title:"Seleciona Data Base da planilha"}},[t._v("\n              Data Base:\n              "),a("b-form-select",{attrs:{options:t.registros},model:{value:t.newparams.base,callback:function(e){t.$set(t.newparams,"base",e)},expression:"newparams.base"}})],1),a("div",{staticClass:"field"},[a("b-form-checkbox",{attrs:{size:"lg",switch:"",variant:"danger",value:"1","unchecked-value":"0"},model:{value:t.newparams.desonerado,callback:function(e){t.$set(t.newparams,"desonerado",e)},expression:"newparams.desonerado"}},[t._v("Desonerado\n            ")])],1)]),a("span",{staticClass:"titulo"},[t._v("\n        Selecione uma planilha que tenha este layout de colunas\n      ")]),a("div",{staticClass:"table"},[a("div",{staticClass:"tr header"},[a("div",{staticClass:"td header"},[t._v("Item")]),a("div",{staticClass:"td header"},[t._v("Orgão")]),a("div",{staticClass:"td header"},[t._v("Código")]),a("div",{staticClass:"td header",staticStyle:{"min-width":"50px"}},[t._v("Descrição")]),a("div",{staticClass:"td header"},[t._v("Unid")]),a("div",{staticClass:"td header"},[t._v("Qtde")]),a("div",{staticClass:"td header"},[t._v("Valor Unit")]),a("div",{staticClass:"td header"},[t._v("Valor Total")])]),a("div",{staticClass:"tr ",staticStyle:{"font-size":"12px"}},[a("div",{staticClass:"td "},[t._v("Sequenciamento dos Itens")]),a("div",{staticClass:"td "},[t._v("Orgão de referência")]),a("div",{staticClass:"td "},[t._v("Código de referência")]),a("div",{staticClass:"td ",staticStyle:{"min-width":"50px"}},[t._v("Descrição do Item")]),a("div",{staticClass:"td "},[t._v("Unidade")]),a("div",{staticClass:"td "},[t._v("Qtde do Item")]),a("div",{staticClass:"td "},[t._v("Preço Unitário")]),a("div",{staticClass:"td "},[t._v("Preço Total")])])]),a("div",{staticClass:"d-block "},[a("b-form-file",{staticStyle:{"text-align":"left !important"},attrs:{id:"nomeplanilha",state:Boolean(t.file),placeholder:"Escolha a planilha a ser lida...",value:t.file},on:{change:function(e){return t.carregaArquivo()}},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}}),a("span",{staticClass:"titulo"},[t._v("\n        Informe os dados da planilha\n      ")]),a("div",{staticClass:"camposplanilha"},[a("div",{staticClass:"field",attrs:{title:"Seleciona a guia da planilha"}},[t._v("\n            Nome da Guia: \n            "),a("b-form-select",{attrs:{options:t.guias},model:{value:t.guia,callback:function(e){t.guia=e},expression:"guia"}})],1),a("div",{staticClass:"field",attrs:{title:"Define Primeira linha com Itens"}},[t._v("\n          1\tª Linha:\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.linha1,expression:"linha1"}],attrs:{type:"number",step:"1",min:"0",max:"80"},domProps:{value:t.linha1},on:{input:function(e){e.target.composing||(t.linha1=e.target.value)}}})]),a("div",{staticClass:"field",attrs:{title:"Define Primeira coluna com Itens"}},[t._v("\n          1\tª Coluna:\n          "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.coluna1,expression:"coluna1"}],staticStyle:{width:"50px !important"},attrs:{type:"text",maxlength:"1"},domProps:{value:t.coluna1},on:{input:function(e){e.target.composing||(t.coluna1=e.target.value)}}})])])],1),a("b-button",{staticClass:"mt-3",attrs:{block:"",variant:"warning"},on:{click:function(e){return t.readSheet()}}},[t._v("Carregar")])],1)]),a("b-modal",{attrs:{id:"modal_atualiza",centered:"","content-class":"shadow","header-bg-variant":"light","header-text-variant":"info","body-bg-variant":"light","body-text-variant":"danger","footer-bg-variant":"light",title:"Atualiza Itens"},on:{ok:function(e){return t.atualizaItens()}}},[a("p",{staticClass:"my-2"},[t._v("\n      Um dos parâmetros da planilha foi alterado ! \n      Deseja atualizar os itens desta planilha com base nessa alteração?\n    ")])]),a("Progress",{attrs:{progressstate:t.progressstate,max:t.max}}),a("Loading",{attrs:{loading:t.lendo}})],1)},n=[],l=(a("34ef"),a("8615"),a("ac6a"),a("456d"),a("28a5"),a("75fc")),c=(a("96cf"),a("3b8d")),d=a("1146"),u=a.n(d),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{directives:[{name:"show",rawName:"v-show",value:t.max>1,expression:"max>1"}],staticClass:"progresscard"},[a("b-progress",{staticClass:"progresso",attrs:{max:t.max,"show-progress":"",animated:"","show-value":"",variant:"warning",height:"2.5rem"}},[a("b-progress-bar",{staticClass:"td header",attrs:{value:t.progressstate}},[t._v("\n        Atualizando: "),a("strong",[t._v(t._s(t.progressstate)+" / "+t._s(t.max))])])],1)],1)},m=[],v={name:"progresso",props:["progressstate","max"]},f=v,h=(a("679a"),a("2877")),g=Object(h["a"])(f,p,m,!1,null,null,null),b=g.exports,x=(a("a481"),a("6b54"),{methods:{criticaItem:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a,s){var i,r,o,n,l,c,d,u,p,m,v,f,h,g;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=[],r=[],""!=e.codigo){t.next=3;break}return t.abrupt("return",JSON.stringify(i)+"||"+JSON.stringify(r));case 3:if(!(e.orgao.toString().toUpperCase().indexOf("COMP")>=0||"CCU"==e.orgao.toString().toUpperCase().replace(".",""))){t.next=5;break}return t.abrupt("return",JSON.stringify(i)+"||"+JSON.stringify(r));case 5:return o=e.codigo,n=a.desonerado,l=e.orgao,c=a.BDI,d=a.UF,u=e.base,p="codigo.asp?uf="+d+"&orgao="+l+"&base="+u+"&codigo="+o,t.next=14,s.$http.get(p).then((function(t){return t.data[0]}));case 14:if(m=t.sent,e.vlComBDI*e.qtd==0&&i.push({erro:"Item com Preço/Qtde zerada"}),""!=m&&void 0!=m){t.next=19;break}return i.push({erro:"Item não cadastrado nesse Orgão/Base/UF"}),t.abrupt("return",JSON.stringify(i)+"||"+JSON.stringify(r));case 19:return m.descr.toUpperCase()!==e.descr.toUpperCase()&&r.push({alerta:"Verifique a descrição do item"}),v=s.itens.filter((function(t){return t.codigo==e.codigo})),v.length>1&&(f=v[0].vlComBDI,h=s.itens.filter((function(t){return t.vlComBDI!==f&&e.codigo==t.codigo})),h.length>0&&i.push({erro:"Item repetido com valor diferente."})),g="",g="1"==n?parseFloat(m.precodeson*(1+c/100)).toFixed(2):parseFloat(m.precooner*(1+c/100)).toFixed(2),parseFloat(e.vlComBDI)>parseFloat(g)&&g>0&&i.push({erro:"Item com preço maior que a referência"}),parseFloat(e.vlComBDI)<parseFloat(.7*g)&&g>0&&r.push({alerta:"Item com preço menor que a 70% da referência"}),t.abrupt("return",JSON.stringify(i)+"||"+JSON.stringify(r)+"||"+g);case 27:case"end":return t.stop()}}),t)})));function e(e,a,s){return t.apply(this,arguments)}return e}()}}),w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.loading?a("div",{staticClass:"loading"},[a("i",{staticClass:"fa fa-spinner fa-pulse fa-3x fa-fw"}),a("span",[t._v("Carregando...")])]):t._e()},C=[],y={name:"loading",props:["loading"],create:function(){this.loading=!0}},I=y,_=(a("8e69"),Object(h["a"])(I,w,C,!1,null,null,null)),k=_.exports,O={name:"Params",components:{Loading:k,Progress:b},mixins:[x],data:function(){return{oldparams:"",file:[],emcima:!1,registros:[],newparams:{UF:"",base:"",desonerado:"1",BDI:""},atualiza:"",linha1:7,coluna1:"A",lendo:!1,guia:"",max:0,progressstate:0,workbook:"",guias:[]}},methods:{toast:function(t,e){this.$bvToast.toast(t,{title:"Mensagem",toaster:"b-toaster-top-center",solid:!0,variant:e})},atualizaItens:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i,r,o,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=function(){return n=Object(c["a"])(regeneratorRuntime.mark((function t(o){var n,l,c,d,u,p,m,v,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:n=0;case 1:if(!(n<r.length)){t.next=36;break}if(o.progressstate=o.progressstate+1,l=r[n],l.erro=[],!(""!==l.orgao&&""!==l.codigo&&l.orgao.toUpperCase().indexOf("COMP")<0&&l.orgao.toUpperCase().indexOf("CCU")<0&&l.orgao.toUpperCase().indexOf("C.C.U")<0)){t.next=33;break}if(d=s,"SINAPI"===l.orgao.toUpperCase()){t.next=11;break}return t.next=10,o.$http.get("carregaorgao.asp?uf="+i+"&base="+s+"&orgao="+l.orgao).then((function(t){return t.data[0].base})).catch((function(t){return""}));case 10:d=t.sent;case 11:if(""===d){t.next=32;break}return c="codigo.asp?uf="+i+"&codigo="+l.codigo+"&base="+d+"&orgao="+l.orgao,t.next=15,o.$http.get(c).then((function(t){return t.data[0]}));case 15:return u=t.sent,void 0==u?(l.valor=0,l.valortot=""):l.valor="1"==a?parseFloat(u.precodeson*(1+e/100)).toFixed(2):parseFloat(u.precooner*(1+e/100)).toFixed(2),l.base=d,l.vlComBDI=l.valor,l.valortot=parseFloat(l.qtd*l.vlComBDI).toFixed(2),t.next=22,o.criticaItem(l,o.params,o);case 22:p=t.sent,m=p.split("||")[0],m&&(l.erro=JSON.parse(m)),v=p.split("||")[1],v&&(l.alerta=JSON.parse(v)),f=p.split("||")[2],f>0&&(l.valor=f),o.itens[n]=l,t.next=33;break;case 32:l.orgao.indexOf("COMP")>-1?l.composicao=!0:l.erro.push({erro:"Item não encontrado no orgão/data base"});case 33:n++,t.next=1;break;case 36:case"end":return t.stop()}}),t)}))),n.apply(this,arguments)},o=function(t){return n.apply(this,arguments)},0!=this.itens.length){t.next=4;break}return t.abrupt("return");case 4:return e=this.params.BDI,a=this.params.desonerado,s=this.params.base,i=this.params.UF,r=Object(l["a"])(this.itens),this.max=r.length,t.next=12,o(this);case 12:this.itens=r,this.max=0,this.progressstate=0,this.toast("Itens atualizados com sucesso !","success");case 15:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),confirmUpdate:function(){this.$bvModal.show("modal_atualiza")},gravabase:function(t){this.params.base=t.base,this.saveParams()},totalizaItens:function(){this.$store.commit("totalizaItens")},pesquisaBases:function(){if(void 0!=this.params.UF){var t="carregabase.asp?uf="+this.params.UF;return this.$http.get(t).then((function(t){var e=[];e.push({value:"",text:"Data Base"});for(var a=0;a<Object.keys(t.data).length;a++)e.push({value:t.data[a].base,text:t.data[a].base});return e}))}},saveParams:function(){this.$store.commit("gravaParams",this.params)},escolheArquivo:function(){""!=this.params.UF?this.$bvModal.show("modal-2"):this.toast("Selecione uma UF antes de importar planilhas !","danger")},salvaItens:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var a,s,i,r,o,n,l,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=[],this.max=e.length,s=parseInt(this.coluna1.toUpperCase().charCodeAt()-64),i=this.linha1-3;case 4:if(!(i<Object.keys(e).length-1)){t.next=30;break}return r={item:"",orgao:"",base:this.params.base,descr:"",unid:"",qtd:"",valor:"",erro:"",valortot:"",selecionado:!1,edita:!1,vlComBDI:0},r.item=Object.values(e[i])[s-1],r.orgao=Object.values(e[i])[s],r.codigo=Object.values(e[i])[s+1],r.descr=Object.values(e[i])[s+2],r.unid=Object.values(e[i])[s+3],r.qtd=Object.values(e[i])[s+4],""!==r.qtd&&(r.qtd=parseFloat(r.qtd).toFixed(2)),r.vlComBDI=Object.values(e[i])[s+5],""!==r.vlComBDI&&(r.vlComBDI=parseFloat(r.vlComBDI).toFixed(2)),r.valortot=Object.values(e[i])[s+6],t.next=18,this.criticaItem(r,this.params,this);case 18:o=t.sent,n=o.split("||")[0],n&&(r.erro=JSON.parse(n)),l=o.split("||")[1],l&&(r.alerta=JSON.parse(l)),c=o.split("||")[2],c>0&&void 0!==c&&(r.valor=c),"total"!==r.descr.toLowerCase()&&r.descr.toLowerCase().indexOf("sub-total")<0&&r.descr.toLowerCase().indexOf("subtotal")<0&&""!==r.descr&&a.push(r),this.progressstate=this.progressstate+1;case 27:i++,t.next=4;break;case 30:e=a,this.itens=e,this.$store.commit("gravaItens",e),this.$store.commit("calculatotal"),this.$forceUpdate(),this.max=0,this.progressstate=0;case 37:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),carregaArquivo:function(){var t=this,e=document.getElementById("nomeplanilha").files[0];if(""!=e){this.toast("Aguarde a leitura da planilha. Isso pode demorar um pouco...","primary"),this.lendo=!0,this.$forceUpdate(),this.$store.commit("gravaItens",[]),this.itens=[];var a=this;setTimeout((function(){t.carregaArquivocontinua(e,a)}),2500)}else alert("Selecione uma planilha !")},carregaArquivocontinua:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var s,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:r=function(){return r=Object(c["a"])(regeneratorRuntime.mark((function t(e){var a,s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(a="",s=0,i=10240;s<e.byteLength/i;++s)a+=String.fromCharCode.apply(null,new Uint8Array(e.slice(s*i,s*i+i)));return a+=String.fromCharCode.apply(null,new Uint8Array(e.slice(s*i))),t.abrupt("return",a);case 4:case"end":return t.stop()}}),t)}))),r.apply(this,arguments)},i=function(t){return r.apply(this,arguments)},s=new FileReader,s.onload=function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var s,r,o,n,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=e.target.result,a.lendo=!0,t.next=4,i(s);case 4:for(r=t.sent,o=u.a.read(btoa(r),{type:"base64"}),n=[],l=0;l<o.SheetNames.length;l++)n.push(o.SheetNames[l]);a.guias=n,a.workbook=o,a.lendo=!1,a.toast("Planilha carregada. Informe os dados da planilha...","success"),a.$forceUpdate();case 13:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),s.readAsArrayBuffer(e),this.params.BDI=this.newparams.BDI,this.params.base=this.newparams.base,this.params.desonerado=this.newparams.desonerado,this.saveParams();case 9:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),readSheet:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(""!=this.newparams.BDI&&""!=this.newparams.base&&""!=this.guia){t.next=3;break}return this.toast("Informe Data Base e/ou BDI e/ou Nome da Guia","danger"),t.abrupt("return");case 3:e=this.workbook.Sheets[this.guia],a=u.a.utils.sheet_to_json(e,{defval:""}),this.salvaItens(a),this.$bvModal.hide("modal-2");case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onexport:function(){var t=[];this.itens.forEach((function(e){t.push({Item:e.item,"Orgão":e.orgao,"Código":e.codigo,"Descrição":e.descr,Unid:e.unid,Qtdade:e.qtd,"Preço Unitário":e.vlComBDI,"Preço Total":e.valortot})}));var e=u.a.utils.json_to_sheet(t),a=u.a.utils.book_new();u.a.utils.book_append_sheet(a,e,"Itens");var s=[{wpx:40},{wpx:70},{wpx:70},{wpx:450},{wpx:50},{wpx:40},{wpx:70},{wpx:90},{hidden:!0}];e["!cols"]=s,u.a.writeFile(a,"book.xlsx")},limpaPlanilha:function(){var t=this;confirm("Deseja apagar os dados desta planilha ?")&&(this.$store.commit("gravaParams",{BDI:"",UF:"",base:"",desonerado:""}),this.$store.commit("gravaItens",[]),setTimeout((function(){t.$store.commit("calculatotal")}),1e3,this))}},beforeMount:function(){this.oldparams=JSON.stringify(this.params)},watch:{params:{handler:function(t){this.oldparams.indexOf('"UF":""')<0&&JSON.stringify(t)!==this.oldparams&&""!==t.UF&&this.itens.length>0&&this.$bvModal.show("modal_atualiza"),this.oldparams=JSON.stringify(this.params)},deep:!0}},computed:{params:function(){return this.$store.state.params},itens:function(){return this.$store.state.itens}},asyncComputed:{bases:function(){var t=this;if(void 0==this.params.UF||this.params.UF.length<2)return"";var e="carregabase.asp?uf="+this.params.UF;return this.$http.get(e).then((function(e){for(var a=[],s=0;s<Object.keys(e.data).length;s++)a.push({value:e.data[s].base,text:e.data[s].base});return t.registros=a,a}))}}},S=O,P=(a("e26a"),Object(h["a"])(S,o,n,!1,null,null,null)),D=P.exports,$=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"divGrid"},[a("keep-alive",[a("Item")],1)],1)},B=[],F=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"conteudoGrid",class:{zoom:t.zoom}},[a("div",{staticClass:"table"},[a("div",{staticClass:"tr header",on:{dblclick:function(e){t.zoom=!t.zoom}}},[a("div",{staticClass:"td header",staticStyle:{width:"9% !important"}},[t._v("Item")]),a("div",{staticClass:"td header",staticStyle:{width:"9% !important"}},[t._v("Orgão")]),a("div",{staticClass:"td header",staticStyle:{width:"9% !important"}},[t._v("Código")]),a("div",{staticClass:"td header",staticStyle:{width:"30% !important"}},[t._v("Descrição")]),a("div",{staticClass:"td header",staticStyle:{width:"5% !important"}},[t._v("Unid")]),a("div",{staticClass:"td header",staticStyle:{width:"9% !important"}},[t._v("Qtde ")]),a("div",{staticClass:"td header",staticStyle:{width:"9% !important"}},[t._v("Valor Unit")]),a("div",{staticClass:"td header",staticStyle:{width:"9% !important"}},[t._v("Valor Total")]),a("div",{staticClass:"td header",staticStyle:{width:"10% !important"}},[a("div",{staticClass:"acao"},[a("i",{staticClass:"fa fa-times-circle-o text-danger fa-1x",class:{filtrado:t.mostraerro},on:{click:function(e){t.mostraalerta=!1,t.mostraerro=!t.mostraerro}}}),a("i",{staticClass:"fa fa-exclamation-circle text-warning",class:{filtrado:t.mostraalerta},on:{click:function(e){t.mostraerro=!1,t.mostraalerta=!t.mostraalerta}}}),a("i",{staticClass:"fa fa-plus-square fa-1x text-light",attrs:{title:"Inserir Item"},on:{click:function(e){return t.addRow()}}})])])]),t._l(t.itens,(function(e,s){return a("div",{directives:[{name:"show",rawName:"v-show",value:!t.mostraerro&&!t.mostraalerta||t.mostraerro&&e.erro.length>0||t.mostraalerta&&e.alerta.length>0,expression:"!mostraerro&&!mostraalerta||(mostraerro&&item.erro.length>0)||(mostraalerta&&item.alerta.length>0)"}],key:s,ref:"tr-"+s,refInFor:!0,staticClass:"tr",class:{composicao:e.composicao,erro:e.erro.length,LinhaPar:s%2==0,Selected:e.selecionado,alerta:e.alerta.length,Grupo:""==e.orgao&&""==e.codigo&&""==e.unid&&""==e.qtd&&""==e.vlComBDI,Totais:e.descr.indexOf("Total")>-1&&""!==e.codigo},attrs:{id:"linha"+s},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"esc",27,a.key,["Esc","Escape"])?null:t.saiSemGravar(e)},click:function(e){return t.selecionaItem(s)}}},[a("div",{staticClass:"td"},[a("div",[a("input",{directives:[{name:"model",rawName:"v-model",value:e.item,expression:"item.item"}],class:{editavel:e.edita},attrs:{type:"text",disabled:!e.edita},domProps:{value:e.item},on:{input:function(a){a.target.composing||t.$set(e,"item",a.target.value)}}})])]),a("div",{staticClass:"td"},[a("div",{class:{hide:""==e.orgao&&""==e.codigo&&""==e.unid&&""==e.qtd&&""==e.vlComBDI&&!e.add}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.orgao,expression:"item.orgao"}],ref:"itm-"+s,refInFor:!0,class:{editavel:e.edita},attrs:{type:"text",disabled:!e.edita},domProps:{value:e.orgao},on:{input:[function(a){a.target.composing||t.$set(e,"orgao",a.target.value)},t.pesquisaOrgaos]}}),a("Autocomplete",{class:{emcima:t.emcima,autocompleteAtivo:e.edita},attrs:{campo1:0,campo2:1,arrayRegistros:t.registrosOrgao},on:{retorno:function(e){return t.selecionaOrgao(e)}}})],1)]),a("div",{staticClass:"td"},[a("div",{class:{hide:""==e.orgao&&""==e.codigo&&""==e.unid&&""==e.qtd&&""==e.vlComBDI&&!e.add}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.codigo,expression:"item.codigo"}],class:{editavel:e.edita},attrs:{type:"text",id:"codigo",disabled:!e.edita},domProps:{value:e.codigo},on:{change:t.codigo,input:function(a){a.target.composing||t.$set(e,"codigo",a.target.value)}}})])]),a("div",{staticClass:"td"},[a("div",{staticClass:"descricao"},[a("b-form-textarea",{class:{editavel:e.edita},staticStyle:{"text-align":"left"},attrs:{tabindex:"0",disabled:!e.edita,rows:"1","max-rows":"6"},on:{input:function(e){return t.pesquisa(e)}},model:{value:e.descr,callback:function(a){t.$set(e,"descr",a)},expression:"item.descr"}}),Object.keys(t.ItensPesquisados).length?a("ul",{ref:"auto",refInFor:!0,staticClass:"autocomplete",class:{emcima:t.emcima,autocompleteAtivo:e.edita}},t._l(t.ItensPesquisados,(function(e,s){return a("li",{key:s,staticClass:"itenLi",attrs:{tabindex:"-1"},on:{click:function(a){return t.selecItemPesquisado(e)}}},[a("textarea",{attrs:{type:"text"},domProps:{value:e.descr},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.selecItemPesquisado(e)}}})])})),0):t._e()],1)]),a("div",{staticClass:"td"},[a("div",{class:{hide:""==e.orgao&&""==e.codigo&&""==e.unid&&""==e.qtd&&""==e.vlComBDI&&!e.add}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.unid,expression:"item.unid"}],class:{editavel:e.edita},attrs:{type:"text",disabled:!e.edita},domProps:{value:e.unid},on:{input:function(a){a.target.composing||t.$set(e,"unid",a.target.value)}}})])]),a("div",{staticClass:"td"},[a("div",{class:{hide:""==e.orgao&&""==e.codigo&&""==e.unid&&""==e.qtd&&""==e.vlComBDI&&!e.add}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.qtd,expression:"item.qtd"}],ref:"qtd-"+s,refInFor:!0,class:{editavel:e.edita},attrs:{type:"number",disabled:!e.edita},domProps:{value:e.qtd},on:{change:function(t){return e.qtd.replace(",",".")},keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.gravaItem(a,e)},input:function(a){a.target.composing||t.$set(e,"qtd",a.target.value)}}})])]),a("div",{staticClass:"td"},[a("div",{class:{hide:""==e.orgao&&""==e.codigo&&""==e.unid&&""==e.qtd&&""==e.vlComBDI&&!e.add}},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.vlComBDI,expression:"item.vlComBDI"}],class:{editavel:e.edita},attrs:{type:"text",disabled:!e.edita},domProps:{value:e.vlComBDI},on:{keyup:function(a){return!a.type.indexOf("key")&&t._k(a.keyCode,"enter",13,a.key,"Enter")?null:t.gravaItem(a,e)},input:function(a){a.target.composing||t.$set(e,"vlComBDI",a.target.value)}}})])]),a("div",{staticClass:"td",attrs:{title:"Valor Total do Item"}},[a("span",[t._v(t._s(parseFloat(e.valortot)>0?e.valortot:""))])]),a("div",{staticClass:"td"},[a("div",{staticClass:"acoes"},[1==e.edita?a("div",{attrs:{title:"Grava Item"},on:{click:function(a){return t.gravaItem(a,e)}}},[a("i",{staticClass:"fa fa-check-square-o text-success"})]):t._e(),1==e.edita?a("div",{attrs:{title:"Sai sem gravar Item"},on:{click:function(a){return t.saiSemGravar(e)}}},[a("i",{staticClass:"fa fa-times text-secondary"})]):t._e(),0==e.edita?a("div",{attrs:{title:"Edita Item"},on:{click:function(a){return t.editaItem(e)}}},[a("i",{staticClass:"fa fa-edit text-info"})]):t._e(),0==e.edita?a("div",{attrs:{title:"Exclui Item"},on:{click:function(a){return t.excluiItem(e)}}},[a("i",{staticClass:"fa fa-trash text-danger"})]):t._e(),a("div",{attrs:{title:"Crítica Item",id:"info-"+s}},[""!==e.orgao&&""!==e.codigo?a("i",{staticClass:"fa fa-info-circle text-primary"}):t._e()])])]),a("b-popover",{attrs:{target:"info-"+s,triggers:"hover",placement:"left",variant:"info"},scopedSlots:t._u([{key:"title",fn:function(){return[t._v("Detalhes do Item")]},proxy:!0}],null,!0)},[a("b-row",{staticClass:"infoItem"},[a("div",[a("strong",[t._v(" Item : ")]),a("span",[t._v(" "+t._s(e.item))])]),a("div",[a("strong",[t._v(" Orgão :")]),t._v(" "+t._s(e.orgao)+"\r\n          ")]),a("div",[a("strong",[t._v("Data Base : ")]),t._v(t._s(e.base.toUpperCase())+"\r\n          ")]),a("div",[a("strong",[t._v("Código : ")]),t._v(t._s(e.codigo)+"\r\n          ")]),a("div",[a("strong",[t._v("Unid : ")]),t._v(t._s(e.unid)+"\r\n          ")]),a("div",[a("strong",[t._v("Qtde :")]),t._v(" "+t._s(e.qtd)+"\r\n          ")]),a("div",[a("strong",[t._v("Preço Referencial : ")]),t._v(t._s(isNaN(e.valor)||0==e.valor?"":e.valor)+"\r\n          ")]),a("div",[a("strong",[t._v("Preço Unitário : ")]),t._v(t._s(isNaN(e.vlComBDI)||0==e.vlComBDI?"":e.vlComBDI)+"\r\n          ")]),a("div",[a("strong",[t._v("Preço Total : ")]),t._v(t._s(parseFloat(e.valortot)>0?e.valortot:"")+"\r\n          ")])]),a("b-row",{staticClass:"infoItem"},[a("div",[a("strong",[t._v("Descrição : ")]),t._v(t._s(e.descr)+"\r\n          ")])]),e.erro.length?a("b-row",{staticClass:"infoItem"},[a("div",[a("strong",[t._v("Erros : ")]),t._v(t._s(e.erro.length)),a("br"),t._l(e.erro,(function(e,s){return a("div",{key:s,staticClass:"infoErro"},[a("i",{staticClass:"fa fa-thumbs-down text-danger fa-2x"}),t._v("\r\n                 "+t._s(e.erro)+"\r\n            ")])}))],2)]):t._e(),e.alerta.length?a("b-row",{staticClass:"infoItem"},[a("div",[a("strong",[t._v("Avisos : ")]),t._v(t._s(e.alerta.length)),a("br"),t._l(e.alerta,(function(e,s){return a("div",{key:s,staticClass:"infoErro"},[a("i",{staticClass:"fa fa-exclamation-triangle text-warning fa-2x"}),t._v("\r\n                 "+t._s(e.alerta)+"\r\n            ")])}))],2)]):t._e()],1)],1)}))],2),a("Loading",{attrs:{loading:t.loading}})],1)},U=[],q=(a("3b2b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ul",{directives:[{name:"show",rawName:"v-show",value:t.registros.length,expression:"registros.length"}],staticClass:"autocomplete",class:{left:t.left},staticStyle:{width:"8vw !important"}},t._l(t.registros,(function(e,s){return a("li",{key:s,attrs:{tabindex:s-1},on:{click:function(e){return t.selecionaItem(s)}}},[a("textarea",{domProps:{value:Object.values(e)[t.campo1]+" | "+Object.values(e)[t.campo2]},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.selecionaItem(s)}}})])})),0)}),j=[],N={name:"autocomplete",props:["arrayRegistros","campo1","campo2","left"],data:function(){return{exibe:!1}},methods:{selecionaItem:function(t){this.$emit("retorno",this.registros[t]),this.registros.length=0,this.$forceUpdate()}},computed:{registros:function(){return this.arrayRegistros}}},R=N,z=(a("6da4"),Object(h["a"])(R,q,j,!1,null,null,null)),E=z.exports,T={name:"itensPlanilha",components:{Autocomplete:E,Loading:k},props:[],mixins:[x],data:function(){return{zoom:!1,add:!1,emcima:!1,jafoi:!1,BDI:"",orgao:"",base:"",UF:"",desonerado:"",orgaos:[],bases:[],descr:"",ItensPesquisados:[],registrosBase:"",registrosOrgao:[],focus:99,mostraerro:!1,mostraalerta:!1}},methods:{editaItem:function(t){this.itens.map((function(t){return t.edita=!1})),this.selecionado=t.id,t.edita=!0},chamaItens:function(){this.$bvModal.show("modal-itens")},toast:function(t,e){this.$bvToast.toast(t,{title:"Mensagem",toaster:"b-toaster-top-center",solid:!0,variant:e})},naoedita:function(t){""==t.descr&&setTimeout((function(){t.edita=!1}),1e3),this.ItensPesquisados=[]},selecionaOrgao:function(t){this.itens[this.selecionado].orgao=t.orgao,this.itens[this.selecionado].base=t.base,this.registrosOrgao=[]},codigo:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e){var a,s,i,r,o,n,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.type,s=e.target,"change"!=a){t.next=19;break}return i=this.itens[this.selecionado],r=this.params.BDI,o="codigo.asp?uf="+this.params.UF+"&codigo="+s.value+"&base="+this.itens[this.selecionado].base+"&orgao="+this.itens[this.selecionado].orgao,t.next=7,this.$http.get(o).then((function(t){return t.data[0]}));case 7:if(n=t.sent,""!=n&&void 0!=n){t.next=10;break}return t.abrupt("return","");case 10:l=0,l=1==this.params.desonerado?n.precodeson:n.precooner,i.valor=l,i.unid=n.unid,i.descr=n.descr,i.vlComBDI=parseFloat(l*(1+r/100)).toFixed(2),i.valortot=parseFloat(i.vlComBDI*i.qtd).toFixed(2),this.$refs["qtd-"+this.selecionado][0].focus(),this.$forceUpdate();case 19:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),pesquisaOrgaos:function(t){var e=this,a=t.target;if(!(a.value.length<4)&&""!=this.itens[this.selecionado].orgao){var s=this.params.base;this.$http.get("carregaorgao.asp?uf="+this.params.UF+"&orgao="+a.value+"&base="+s).then((function(t){var a=[],i=!1;JSON.stringify(t.data).toLowerCase().indexOf(s.toLowerCase())>0&&(i=!0);for(var r=0;r<Object.keys(t.data).length;r++)i&&t.data[r].base==s&&a.push(t.data[r]),i||t.data[r].base===s||a.push(t.data[r]),a.length>0&&(r=Object.keys(t.data).length);e.registrosOrgao=a,e.$forceUpdate()}))}},removeAcento:function(t){return t=t.toLowerCase(),t=t.replace(new RegExp("[ÁÀÂÃ]","gi"),"a"),t=t.replace(new RegExp("[ÉÈÊ]","gi"),"e"),t=t.replace(new RegExp("[ÍÌÎ]","gi"),"i"),t=t.replace(new RegExp("[ÓÒÔÕ]","gi"),"o"),t=t.replace(new RegExp("[ÚÙÛ]","gi"),"u"),t=t.replace(new RegExp("[Ç]","gi"),"c"),t},pesquisa:function(t){var e=this,a=t.toString();if(!(a.length<6))if(""!=this.itens[this.selecionado].orgao){this.$store.commit("setLoading",!0);var s="descricao.asp?uf="+this.params.UF+"&descr="+this.removeAcento(a)+"&orgao="+this.itens[this.selecionado].orgao+"&base="+this.itens[this.selecionado].base;this.$http.get(s).then((function(t){e.ItensPesquisados=t.data,e.$store.commit("setLoading",!1),e.$forceUpdate()}))}else this.toast("Informe o orgão para consultar itens","warning")},selecItemPesquisado:function(t){this.itens[this.selecionado].orgao=t.orgao,this.itens[this.selecionado].codigo=t.codigo,this.itens[this.selecionado].descr=t.descr,this.itens[this.selecionado].base=t.base,"1"==this.params.desonerado?this.itens[this.selecionado].valor=t.precodeson:this.itens[this.selecionado].valor=t.precooner,this.itens[this.selecionado].unid=t.unid,this.itens[this.selecionado].vlComBDI=parseFloat(this.itens[this.selecionado].valor*(1+this.params.BDI/100)).toFixed(2),this.$bvModal.hide("modal-1"),this.$refs["qtd-"+this.selecionado][0].focus(),this.ItensPesquisados=[]},selecionaItem:function(t){this.itens.forEach((function(t){t.selecionado=!1})),t>=this.itens.length&&(t=this.itens.length-1),this.itens[t].selecionado=!0,this.selecionado=t,this.add=!1,this.$forceUpdate()},saiSemGravar:function(t){t.edita=!1;var e=t.id;this.ItensPesquisados=[],this.registrosOrgao=[],this.jafoi=!1,this.emcima=!1,""==t.descr&&this.itens.splice(e,1),this.$store.commit("calculatotal")},gravaItem:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(e,a){var s,i,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("codigo"!=e.srcElement.id){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.criticaItem(a,this.params,this);case 4:s=t.sent,a.erro=JSON.parse(s.split("||")[0]),a.alerta=JSON.parse(s.split("||")[1]),i=s.split("||")[2],""==a.valor&&void 0!==i&&(a.valor=s.split("||")[2]),this.$store.commit("gravaItens",this.itens),r=a.id,this.selecionado=r,a.add&&(this.addRow(),this.add=!1),a.edita=!1,a.add=!1,this.ItensPesquisados=[],this.$store.commit("calculatotal"),this.$forceUpdate();case 18:case"end":return t.stop()}}),t,this)})));function e(e,a){return t.apply(this,arguments)}return e}(),excluiItem:function(t){var e=t.id;this.itens.splice(e,1),this.$store.commit("gravaItens",this.itens),localStorage.setItem("itens",JSON.stringify(this.itens)),this.$store.commit("calculatotal")},consulta:function(){var t=this;this.$http.get("carregaorgao.asp?uf=ES").then((function(e){t.orgaos=e.data,t.orgao="Escolha o Orgão"})),this.$http.get("carregabase.asp?uf="+this.UF).then((function(e){t.bases=e.data})),this.$bvModal.show("modal-1")},addRow:function(){var t=Object(c["a"])(regeneratorRuntime.mark((function t(){var e,a,s,i=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this.mostraerro&&!this.mostraalerta){t.next=3;break}return alert("Desative os filtros de Erro/Alerta para inserir itens"),t.abrupt("return");case 3:if(void 0!=this.params.base&&""!=this.params.base){t.next=6;break}return alert("É necessário selecionar uma Data Base para inserir itens"),t.abrupt("return");case 6:if(!(this.itens.length>1&&void 0==this.selecionado)){t.next=9;break}return alert("Selecione um item para inserir outro item apos este !"),t.abrupt("return");case 9:if(this.$forceUpdate(),this.add=!0,e=0,a={id:"",item:"",orgao:"",codigo:"",base:this.params.base,descr:"",unid:"",qtd:"",valor:"",valortot:"",selecionado:!0,edita:!0,vlComBDI:0,add:!0,erro:[],alerta:[]},this.itens.length>0)e=this.selecionado,a.id=e+1,a.edita=!0,a.base=this.itens[e].base,a.orgao=this.itens[e].orgao,this.itens.splice(e+1,0,a),this.selecionado=e+1;else for(this.itens.push(a),s=1;s<this.itens.length;s++)this.item.id=s;this.selecionado=e+1,this.jafoi=!0,this.emcima=!1,setTimeout((function(){var t=i.$refs["tr-"+i.selecionado][0];document.querySelector("#app > div.conteudo > div.grid").scrollTop=t.offsetTop-200}),200);case 18:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}()},updated:function(){if(this.add){this.add=!1;var t=this.selecionado;this.$refs["itm-"+t][0].focus(),this.$refs["tr-"+t][0].scrollIntoView()}this.itens.length-this.selecionado<4&&this.itens.length>5&&(this.emcima=!0,this.jafoi=!1)},created:function(){var t=this;setTimeout((function(){t.selecionado=0}),1500)},watch:{itens:{handler:function(t){this.$store.commit("calculatotal")},deep:!0}},mounted:function(){},computed:{loading:function(){return this.$store.state.loading},itens:function(){return this.$store.state.itens},params:function(){return this.$store.state.params}}},L=T,A=(a("6b5e"),Object(h["a"])(L,F,U,!1,null,null,null)),J=A.exports,M={name:"itens",components:{Item:J},data:function(){return{}},computed:{itens:function(){return this.$store.state.itens}},mounted:function(){},methods:{}},G=M,V=(a("d812"),Object(h["a"])(G,$,B,!1,null,null,null)),Q=V.exports,W=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"resumo"},[a("div",{staticClass:"tutoriais"},[a("i",{staticClass:"fa fa-search",on:{click:t.showIframe}}),t._v("\n    Pesquisa Itens\n  ")]),a("div",{staticClass:"total text-danger"},[a("span",[t._v("\n      Total de Itens:"+t._s(t.itens.length)+"     \n    ")]),a("span",[t._v("\n      Total Orçamento: "+t._s(t.valortotal.toFixed(2).toString().replace(/\B(?=(\d{3})+(?!\d))/g,"."))+"\n    ")])]),t.iframeWeb?a("div",{staticClass:"iframe"},[a("span",[t._v("Clique no ícone 'Pesquisa Itens' para sair")]),a("b-embed",{attrs:{type:"iframe",aspect:"21by9",src:"http://www.netshake.net.br/itensreferencia",allowfullscreen:""}})],1):t._e(),t.iframeIntranet?a("div",{staticClass:"iframe"},[a("span",[t._v("Clique no ícone 'Pesquisa Itens' para sair")]),a("b-embed",{attrs:{type:"iframe",aspect:"21by9",src:"http://www.gigovvt.es.caixa/itensreferencia",allowfullscreen:""}})],1):t._e()])},H=[],K={name:"rodape",data:function(){return{iframeWeb:!1,iframeIntranet:!1}},methods:{showIframe:function(){var t=location.host;t.indexOf("localhost:8082")>-1||t.indexOf("www.gigovvt")>-1?this.iframeIntranet=!this.iframeIntranet:this.iframeWeb=!this.iframeWeb}},mounted:function(){this.$store.commit("calculatotal");var t=this;window.addEventListener("keypress",(function(e){27==e.keyCode&&(e.stopPropagation(),t.iframeIntranet=!1,t.iframeWeb=!1)}))},computed:{valortotal:function(){return isNaN(parseFloat(this.$store.state.totvalor))?0:parseFloat(this.$store.state.totvalor)},itens:function(){return this.$store.state.itens.filter((function(t){return""!==t.codigo&&""!==t.orgao?t:""}))}}},X=K,Y=(a("bc42"),Object(h["a"])(X,W,H,!1,null,null,null)),Z=Y.exports,tt={name:"app",components:{Params:D,Grid:Q,Rodape:Z},mounted:function(){localStorage.getItem("itens")&&this.$store.commit("gravaItens",JSON.parse(localStorage.getItem("itens"))),localStorage.getItem("params")&&this.$store.commit("gravaParams",JSON.parse(localStorage.getItem("params")));var t=this.$el.querySelector(".grid");setTimeout((function(){t.scrollTop=t.scrollHeight}),1500)},computed:{local:function(){return this.$local}}},et=tt,at=(a("034f"),Object(h["a"])(et,i,r,!1,null,null,null)),st=at.exports,it=(a("7f10"),a("f9e3"),a("2dd8"),a("5f5b")),rt=a("2f62"),ot=a("bc3a"),nt=a.n(ot);s["default"].use(rt["a"]),s["default"].use(nt.a);var lt=new rt["a"].Store({axios:nt.a,state:{itens:[],loading:!1,params:[{BDI:"",UF:"",base:"",desonerado:"1"}],baseURL:"",totvalor:"",atualiza:!1,disparaAtualizacao:!1,inicio:!1},mutations:{setLoading:function(t,e){t.loading=e},gravaParams:function(t,e){t.params=e;var a={UF:e.UF,base:e.base,desonerado:e.desonerado,BDI:e.BDI};localStorage.setItem("params",JSON.stringify(a))},totalizaItens:function(t){var e=t.itens;if(e){var a=0,s=0;e=e.filter((function(t){return t.descr.indexOf("Total")<0&&""!==t.descr?t:""}));for(var i=0,r=0;r<e.length;r++)if(e[r].edita=!1,""!==e[r].valor&&(e[r].vlComBDI=parseFloat(e[r].valor*(1+t.params.BDI/100)).toFixed(2),e[r].valortot=parseFloat(e[r].qtd*e[r].vlComBDI).toFixed(2)),""==e[r].unid&&""==e[r].codigo){if(e[r].item=parseInt(a)+1,a=e[r].item+".0",s){var o={item:"",orgao:"",base:"",descr:"SubTotal",unid:"",qtd:"",valor:"",valortot:parseFloat(s).toFixed(2),selecionado:!0,edita:!1,erro:[],alerta:[]};e.splice(r,0,o),s=0,r++}}else{var n=3;parseInt(a)>9&&(n=4),a=(parseFloat(a)+.01).toPrecision(n),e[r].item=a,s+=e[r].qtd*e[r].vlComBDI,i+=e[r].qtd*e[r].vlComBDI}if(s){o={item:"",orgao:"",base:"",descr:"SubTotal",unid:"",qtd:"",valor:"",valortot:parseFloat(s).toFixed(2),selecionado:!0,edita:!1,erro:[],alerta:[]},e.splice(r,0,o),r++;var l={item:"",orgao:"",base:"",descr:"Total Geral",unid:"",qtd:"",valor:"",valortot:parseFloat(i).toFixed(2),selecionado:!0,edita:!1,erro:[],alerta:[]};e.splice(r,0,l)}t.itens=e,localStorage.setItem("itens",JSON.stringify(e))}},calculatotal:function(t){var e=t.itens;e=e.filter((function(t){return t.descr.indexOf("Total")<0&&""!==t.descr?t:""}));var a=e.reduce((function(t,e){return"Total"===e.descr||isNaN(parseFloat(e.valortot))||(t+=parseFloat(e.valortot)),t}),0);t.totvalor=a},gravaItens:function(t,e){if(e){e=e.filter((function(t){return t.descr.toLowerCase().indexOf("subtotal")?t:""}));var a=0;e=e.map((function(t){return t.valortot=parseFloat(t.qtd*t.vlComBDI).toFixed(2),t.id=a,a++,t})),t.itens=e,localStorage.setItem("itens",JSON.stringify(e))}else localStorage.removeItem("itens")}}});nt.a.defaults.baseURL="http://www.netshake.net.br/obra/asp/";var ct=location.host;"localhost:8082"==ct&&(nt.a.defaults.baseURL="http://www.gigovvt.des.es.caixa/obra/asp/"),"www.gigovvt.des.es.caixa"==ct&&(nt.a.defaults.baseURL="http://www.gigovvt.des.es.caixa/obra/asp/"),s["default"].use({install:function(t){t.prototype.$http=nt.a,t.prototype.$local=ct}});var dt=a("3003"),ut=a("edbf");window.axios=a("bc3a"),s["default"].use(ut["a"]),s["default"].use(dt["a"]),s["default"].use(it["a"]),s["default"].config.productionTip=!1,new s["default"]({store:lt,render:function(t){return t(st)}}).$mount("#app")},"626a5":function(t,e,a){t.exports=a.p+"img/pcipay-fred.f0c547a2.png"},"62f2":function(t,e,a){t.exports=a.p+"img/logo-GIGOV-200x168.770be14d.png"},"64a9":function(t,e,a){},"673e":function(t,e,a){},"679a":function(t,e,a){"use strict";var s=a("ebbb"),i=a.n(s);i.a},"6b5e":function(t,e,a){"use strict";var s=a("4212"),i=a.n(s);i.a},"6da4":function(t,e,a){"use strict";var s=a("38b6"),i=a.n(s);i.a},"6ff5":function(t,e,a){t.exports=a.p+"img/reuni.595b668e.png"},"7a16":function(t,e,a){},"8c21":function(t,e,a){t.exports=a.p+"img/banner3.3db659ac.jpg"},"8e69":function(t,e,a){"use strict";var s=a("e823"),i=a.n(s);i.a},a6f6:function(t,e,a){t.exports=a.p+"img/picpay.50314b0b.png"},ba57:function(t,e,a){t.exports=a.p+"img/banner1.81c22b85.jpg"},bc42:function(t,e,a){"use strict";var s=a("673e"),i=a.n(s);i.a},bc5c:function(t,e,a){t.exports=a.p+"img/pdo-logo.91d39546.png"},d812:function(t,e,a){"use strict";var s=a("0c36"),i=a.n(s);i.a},e26a:function(t,e,a){"use strict";var s=a("7a16"),i=a.n(s);i.a},e823:function(t,e,a){},ebbb:function(t,e,a){}});
//# sourceMappingURL=app.9ec28607.js.map